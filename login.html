<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <style>
      span {
        display: none;
        color: red;
      }
    </style>
  </head>
  <body
    style="background-image: url(./_cfae791b-e70e-4705-997f-9474bcd8bc6b.jpg)"
  >
    <div
      style="
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 135px;
      "
    >
      <div class="card" style="width: 18rem; height: 17rem; opacity: 0.8">
        <div
          style="
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
          "
        >
          <h2>Login</h2>
          <input
            type="text"
            class="user"
            placeholder="Enter Username"
            style="margin-top: 20px"
          /><br />
          <span>Username Shouldn't be numbers </span>
          <input
            type="password"
            class="user"
            placeholder="Enter Password"
            style="margin-top: -10px"
          /><br />
          <span>Password Should be 8 characters </span>
          <button class="btn btn-primary">Login</button>
          <a href="./signup.html" style="margin-top: 10px"
            >Dont have Account ? SignIn</a
          >
        </div>
      </div>
    </div>

    <script>
      var a = document.getElementsByClassName("user");
      var span = document.getElementsByTagName("span");
      var card = document.getElementsByClassName("card");
      var btn = document.getElementsByTagName("button");
      var t = 0,
        t1 = 0,
        t2 = 0;
      a[0].addEventListener("change", () => {
        if (!isNaN(a[0].value)) {
          span[0].style.display = "inline";
          span[0].style.position = "relative";
          span[0].style.top = "-20px";
          card[0].style.height = "19rem";
          t = 0;
        } else {
          span[0].style.display = "none";
          span[0].style.position = "relative";
          span[0].style.top = "-20px";
          card[0].style.height = "17rem";
          t = 1;
        }
      });

      a[1].addEventListener("change", () => {
        if (a[1].value.length != 8) {
          span[1].style.display = "inline";
          span[1].style.position = "relative";
          span[1].style.top = "-20px";
          card[0].style.height = "19rem";
          t1 = 0;
        } else {
          span[1].style.display = "none";
          span[1].style.position = "relative";
          span[1].style.top = "-20px";
          card[0].style.height = "17rem";
          t1 = 1;
        }
      });

      btn[0].addEventListener("click", () => {
        if (t && t1) {
          fetch(`https://test-data-nh3f.onrender.com/comments`, { method: "GET" })
            .then((res) => {
              return res.json();
            })
            .then((res) => {
              var as = res.filter(
                (v) => v.id != 1 && v.name == a[0].value && v.pass == a[1].value
              );
              if (as.length == 0) {
                alert("invalid Credentilas");
              } else {
                console.log(as);
                var ss=as.filter(v=>v.test==1)

                if(ss.length!=0)
                {
                  alert("user not logged out")

                }
                else{
                  obj = {
                  name: a[0].value,
                  pass: a[1].value,
                  test: 1,
                };
                obj1 = {
                  name: a[0].value,
                  //pass: a[1].value,
                  //test: 1,
                };
                fetch(`https://test-data-nh3f.onrender.com/comments/${as[0].id}`, {
                  method: "PATCH",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify(obj),
                }).then(() => {
                localStorage.setItem("logindata",JSON.stringify(obj1)); 
                var x=localStorage.getItem("home");
                if(x)
                {
                  window.location.href = "./book.html"  

                } 
                else{
                window.location.href = "./ProjectModify.html"
                }
                }
                );

                }
                
              }
            });
        } else {
          alert("Fill All Details");
        }
      });
    </script>
  </body>
</html>
